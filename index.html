<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkorChat Pro | ELIAV SKORNIK EDITION</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Assistant:wght@200;400;600;700;800&display=swap');
        
        body {
            background-color: #000000;
            color: #e5e5e7;
            font-family: 'Assistant', sans-serif;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .scrollbar-hide::-webkit-scrollbar { display: none; }
        
        .bot-bubble {
            background-color: #1c1c1e;
            border-radius: 28px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }

        .user-bubble {
            background-color: #6bb08d;
            color: #000000;
            border-radius: 20px;
            font-weight: 800;
            box-shadow: 0 2px 10px rgba(107, 176, 141, 0.2);
        }

        .input-area-bg {
            background-color: #1c1c1e;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .skor-green { color: #6bb08d; }
        .skor-bg-green { background-color: #6bb08d; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-msg {
            animation: fadeIn 0.4s ease-out forwards;
        }

        /* ×˜×‘×œ××•×ª Markdown */
        .fact-table {
            width: 100%;
            margin: 15px 0;
            border-collapse: separate;
            border-spacing: 0;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .fact-table th { background: rgba(107, 176, 141, 0.15); color: #6bb08d; padding: 10px; text-align: right; font-size: 0.8rem; }
        .fact-table td { padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 0.9rem; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const App = () => {
            const [apiKey, setApiKey] = useState(localStorage.getItem('SKOR_API_KEY') || '');
            const [showSettings, setShowSettings] = useState(!localStorage.getItem('SKOR_API_KEY'));
            const [messages, setMessages] = useState([
                {
                    role: 'bot',
                    content: `×©×œ×•× ×•×‘×¨×›×”! ğŸ‘‹ ××™×–×” ×™×•×¤×™ ×©×¤× ×™×ª ××œ×™×™! ğŸ¤©\n\n×× ×™ ×”×•× **SkorChat Pro** ğŸ¤– â€“ ×”×‘×™× ×” ×”××œ××›×•×ª×™×ª ×”×™×•×¢×¦×ª ×•×”××ª×§×“××ª, ××©×¨ ×ª×•×›× × ×”, ×¢×•×¦×‘×” ×•×”×•×§××” ×‘×’××•×•×” ×¨×‘×” ×¢×œ ×™×“×™ ×”××™×™×¡×“ ×•×”××¤×ª×— ×”×’××•×Ÿ, **××œ×™××‘ ×¡×§×•×¨× ×™×§**! ğŸ§ ğŸ’¡\n\n×× ×™ ×›××Ÿ ×œ×¨×©×•×ª×š ×›×“×™ ×œ×”×¤×•×š ×›×œ ×©×™×—×” ×œ×—×•×•×™×” ××¢×©×™×¨×”, ××¢× ×™×™× ×ª ×•××¤×•×¨×˜×ª ×‘××™×•×—×“. ×”××•××—×™×•×ª ×©×œ×™ ×”×™× ×œ×¦×œ×•×œ ×œ×¢×•××§× ×©×œ × ×•×©××™×, ×œ×¡×¤×§ × ×™×ª×•×—×™× ××“×•×™×§×™×, ×•×œ×©×ª×£ ××•×ª×š ×‘××™×“×¢ ×¢×©×™×¨ ×•×× ×•×¡×— ×”×™×˜×‘. ğŸ“šâœ’ï¸\n\n××–, ×‘×¨×•×š ×”×‘× ×œ×¢×•×œ× ×©×œ SkorChat Pro. ××” × × ×ª×— ×”×™×•×? âœ¨ğŸ’¬`
                }
            ]);
            const [input, setInput] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const chatEndRef = useRef(null);

            // ×©××™×¨×ª ×”××¤×ª×— ×‘××•×¤×Ÿ ××§×•××™
            const saveKey = (key) => {
                localStorage.setItem('SKOR_API_KEY', key);
                setApiKey(key);
                setShowSettings(false);
            };

            // ×’×œ×™×œ×” ××•×˜×•××˜×™×ª ×œ×ª×—×™×œ×ª ×”×”×•×“×¢×”
            useEffect(() => {
                if (messages.length > 1 && messages[messages.length - 1].role === 'bot') {
                    const lastMsg = document.getElementById(`msg-${messages.length - 1}`);
                    if (lastMsg) lastMsg.scrollIntoView({ behavior: 'smooth', block: 'start' });
                } else {
                    chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });
                }
            }, [messages, isLoading]);

            const handleSend = async () => {
                if (!input.trim() || isLoading) return;
                if (!apiKey) {
                    setShowSettings(true);
                    return;
                }

                const userText = input;
                setMessages(prev => [...prev, { role: 'user', content: userText }]);
                setInput('');
                setIsLoading(true);

                const systemInstruction = `××ª×” SkorChat Pro, ×‘×™× ×” ××œ××›×•×ª×™×ª ××ª×§×“××ª ×‘×‘×¢×œ×•×ª ××œ×™××‘ ×¡×§×•×¨× ×™×§.
                ×¢× ×” ×ª××™×“ ×¢× ×”××•×Ÿ ××™××•×’'×™× ×¨×œ×•×•× ×˜×™×™× âœ¨ğŸš€ğŸ”¥. 
                ×× ×™×© × ×ª×•× ×™× ×”×©×•×•××ª×™×™×, ×”×©×ª××© ×ª××™×“ ×‘×˜×‘×œ××•×ª Markdown.
                ×¡×¤×§ ×ª×©×•×‘×•×ª ××¨×•×›×•×ª, ××¤×•×¨×˜×•×ª ×•××¢× ×™×™× ×•×ª ×××•×“.
                ××ª×” ×ª××™×“ ××¦×™×™×Ÿ ×©× ×•×¦×¨×ª ×¢×œ ×™×“×™ ××œ×™××‘ ×¡×§×•×¨× ×™×§ ×”×’××•×Ÿ. ğŸ§ `;

                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: userText }] }],
                            systemInstruction: { parts: [{ text: systemInstruction }] },
                            tools: [{ "google_search": {} }]
                        })
                    });

                    const data = await response.json();
                    
                    if (data.error) {
                        throw new Error(data.error.message);
                    }

                    const botText = data.candidates?.[0]?.content?.parts?.[0]?.text || "×—×œ×” ×©×’×™××” ×‘×¢×™×‘×•×“. ğŸ§";
                    setMessages(prev => [...prev, { role: 'bot', content: botText }]);
                } catch (error) {
                    setMessages(prev => [...prev, { role: 'bot', content: `×©×’×™××”: ${error.message === 'API key not valid. Please pass a valid API key.' ? '×”××¤×ª×— ×©×”×–× ×ª ×œ× ×ª×§×™×Ÿ.' : '×—×œ×” ×©×’×™××” ×‘×—×™×‘×•×¨.'} ğŸ›°ï¸` }]);
                } finally {
                    setIsLoading(false);
                }
            };

            const parseContent = (text) => {
                const lines = text.split('\n');
                let inTable = false;
                let tableRows = [];
                const result = [];

                lines.forEach((line, i) => {
                    if (line.includes('|') && line.includes('---')) return;
                    if (line.includes('|')) {
                        const cells = line.split('|').map(c => c.trim()).filter(c => c !== '');
                        if (cells.length > 0) {
                            tableRows.push(cells);
                            inTable = true;
                            return;
                        }
                    } else if (inTable) {
                        result.push(
                            <table key={`table-${i}`} className="fact-table">
                                <thead>
                                    <tr>{tableRows[0].map((cell, idx) => <th key={idx}>{cell}</th>)}</tr>
                                </thead>
                                <tbody>
                                    {tableRows.slice(1).map((row, rIdx) => (
                                        <tr key={rIdx}>{row.map((cell, cIdx) => <td key={cIdx}>{cell}</td>)}</tr>
                                    ))}
                                </tbody>
                            </table>
                        );
                        tableRows = [];
                        inTable = false;
                    }

                    if (line.trim() === '') {
                        result.push(<div key={`br-${i}`} className="h-4" />);
                    } else {
                        const formatted = line.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                        result.push(<p key={`p-${i}`} className="mb-2" dangerouslySetInnerHTML={{ __html: formatted }} />);
                    }
                });
                return result;
            };

            return (
                <div className="flex flex-col h-screen overflow-hidden bg-black">
                    {/* Settings Modal */}
                    {showSettings && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-md p-6">
                            <div className="bg-[#1c1c1e] p-8 rounded-[32px] border border-white/10 w-full max-w-md shadow-2xl">
                                <h2 className="text-2xl font-bold mb-2">×”×’×“×¨×ª SkorChat Pro ğŸ¤–</h2>
                                <p className="text-gray-400 text-sm mb-6">×›×“×™ ×œ×©××•×¨ ×¢×œ ××‘×˜×—×” ×‘-GitHub, ×”××¤×ª×— ×©×œ×š × ×©××¨ ×¨×§ ×¢×œ ×”×“×¤×“×¤×Ÿ ×”×–×”.</p>
                                <input 
                                    type="password" 
                                    id="key-input"
                                    placeholder="×”×–×Ÿ ×›××Ÿ ××ª ×”-API Key ×©×œ ×’×•×’×œ..."
                                    className="w-full bg-black/50 border border-white/10 rounded-xl p-4 mb-4 outline-none focus:border-[#6bb08d]"
                                />
                                <button 
                                    onClick={() => saveKey(document.getElementById('key-input').value)}
                                    className="w-full skor-bg-green text-black font-bold py-4 rounded-xl hover:scale-[1.02] transition-transform"
                                >
                                    ×©××•×¨ ×•×”×ª×—×œ ×œ×¢×‘×•×“ ğŸš€
                                </button>
                            </div>
                        </div>
                    )}

                    {/* Header */}
                    <header className="px-6 py-5 flex items-center justify-between border-b border-white/5 bg-black z-30">
                        <div className="flex flex-col">
                            <div className="flex items-center gap-1">
                                <span className="text-2xl font-bold tracking-tighter">SkorChat</span>
                                <span className="text-2xl font-bold skor-green">Pro</span>
                            </div>
                            <span className="text-[10px] text-gray-500 font-bold tracking-[0.2em] -mt-1 uppercase">ELIAV SKORNIK EDITION</span>
                        </div>
                        <div className="flex items-center gap-3">
                            <button onClick={() => setShowSettings(true)} className="text-gray-500 hover:text-white transition-colors">
                                <i className="fas fa-cog"></i>
                            </button>
                            <div className="w-2.5 h-2.5 rounded-full bg-[#6bb08d] shadow-[0_0_12px_#6bb08d] animate-pulse"></div>
                            <span className="text-[10px] text-gray-400 font-bold tracking-widest uppercase">CLOUD CONNECTED</span>
                        </div>
                    </header>

                    {/* Messages Area */}
                    <main className="flex-1 overflow-y-auto p-4 md:p-6 scrollbar-hide">
                        <div className="max-w-2xl mx-auto flex flex-col gap-10 pb-24">
                            {messages.map((msg, i) => (
                                <div key={i} id={`msg-${i}`} className="animate-msg flex flex-col items-start w-full">
                                    {msg.role === 'user' ? (
                                        <div className="user-bubble px-5 py-2.5 max-w-[85%] text-sm mb-2 shadow-lg">
                                            {msg.content}
                                        </div>
                                    ) : (
                                        <div className="bot-bubble p-6 w-full text-lg leading-relaxed mb-2">
                                            {parseContent(msg.content)}
                                        </div>
                                    )}
                                </div>
                            ))}
                            {isLoading && (
                                <div className="flex items-center gap-3 bg-[#1c1c1e] p-5 rounded-3xl w-max border border-white/5 shadow-2xl">
                                    <div className="animate-spin skor-green text-xl"><i className="fas fa-circle-notch"></i></div>
                                    <span className="text-xs text-gray-500 font-bold uppercase tracking-widest">×× ×ª×— × ×ª×•× ×™×...</span>
                                </div>
                            )}
                            <div ref={chatEndRef} />
                        </div>
                    </main>

                    {/* Inventor Credit */}
                    <div className="text-center py-2 opacity-20 pointer-events-none bg-black">
                        <p className="text-[9px] text-gray-500 font-bold tracking-[0.5em] uppercase">
                            INVENTOR: ELIAV SKORNIK | SKORCHAT PRO V10.0
                        </p>
                    </div>

                    {/* Input Console */}
                    <footer className="px-4 pb-12 pt-4 bg-black">
                        <div className="max-w-2xl mx-auto flex items-center gap-3 bg-[#1c1c1e] rounded-full p-2 pl-2 pr-6 shadow-2xl border border-white/10 focus-within:border-[#6bb08d]/40 transition-all duration-300">
                            <button className="p-3 text-gray-500 hover:text-white transition-colors text-2xl">
                                <i className="far fa-image"></i>
                            </button>
                            <input
                                type="text"
                                value={input}
                                onChange={(e) => setInput(e.target.value)}
                                onKeyPress={(e) => e.key === 'Enter' && handleSend()}
                                placeholder="×©××œ ××ª SkorChat Pro..."
                                className="flex-1 bg-transparent border-none outline-none text-right text-gray-100 py-3 text-xl placeholder:text-gray-700 font-medium"
                            />
                            <button
                                onClick={handleSend}
                                disabled={!input.trim() || isLoading}
                                className="w-14 h-14 rounded-full skor-bg-green flex items-center justify-center hover:scale-105 active:scale-90 transition-all shadow-lg disabled:opacity-20"
                            >
                                <i className="fas fa-paper-plane text-black -rotate-45 relative left-1 text-2xl"></i>
                            </button>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

